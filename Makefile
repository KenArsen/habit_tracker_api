# –ì–ª–∞–≤–Ω—ã–π Makefile

# –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–≤–æ–¥–∞)
PROJECT_NAME = habit_tracker_api

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
dev:
	uvicorn app.main:app --host localhost --port 8000 --reload

# –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–µ–∂–∏–º–µ
run:
	uvicorn app.main:app --host 0.0.0.0 --port 8000

# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
clean:
	find . -type d -name "__pycache__" -exec rm -rf {} +
	find . -type f -name "*.pyc" -delete

# –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
migration:
	alembic revision --autogenerate -m "$(message)"

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
migrate:
	alembic upgrade head

.PHONY: help
help:
	@echo "Makefile –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞: $(PROJECT_NAME)"
	@echo ""
	@echo "üõ†Ô∏è  Docker:"
	@echo "  make build               - –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–æ–≤"
	@echo "  make up                  - –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ —Ñ–æ–Ω–µ"
	@echo "  make start               - –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ (—Å –ª–æ–≥–∞–º–∏)"
	@echo "  make stop                - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"
	@echo "  make down                - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"
	@echo "  make restart             - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"
	@echo "  make logs                - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"
	@echo "  make clean               - –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –æ–±—Ä–∞–∑—ã, —Ç–æ–º–∞"
	@echo "  make shell               - –î–æ—Å—Ç—É–ø –∫ bash –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ web"
	@echo ""
	@echo "üêç FastAPI:"
	@echo "  make dev                 - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç"
	@echo ""
	@echo "üöÄ –ë—ã—Å—Ç—Ä–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞:"
	@echo "  make init                - –ë–∏–ª–¥, –∑–∞–ø—É—Å–∫, —Å–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö"
	@echo ""
	@echo "üåê Nginx:"
	@echo "  make deploy-nginx        - –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx"
	@echo "  make remove-nginx        - –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx"
	@echo "  make check-nginx-config  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"
	@echo "  make clear-logs          - –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ Nginx"
	@echo ""
	@echo "üîß –£—Ç–∏–ª–∏—Ç—ã:"
	@echo "  make help                - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É"
